[init]
    rq_key                      ->  w_login     /   send_key
    timer                       ->  init
    _                           ->  logout      /   log_err

[w_login]
    rq_login    &   valid       ->  login       /   send_login
    rq_login                    ->  logout      /   log_err
    timer       &   timeout_wl  ->  logout      /   log_err
    timer                       ->  w_login
    _                           ->  logout      /   log_err

[login]
    rq_logout                   ->  logout      /   send_logout
    heartbeat                   ->  login       /   update_hb
    timer       &   timeout_l   ->  logout
    timer                       ->  login
    _                           ->  logout      /   log_err

[logout]
    timer                       ->  logout
    _                           ->  logout      /   log_err
