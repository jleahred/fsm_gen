[init]
    rq_key                      ->  w_login     /   send_key
    timer                       ->  init
    _                           ->  error

[w_login]
    rq_login    &   valid       ->  login       /   send_login
    rq_login                    ->  error
    timer       &   timeout     ->  error
    timer                       ->  w_login
    _                           ->  error

[login]
    rq_logout                   ->  logout      /   send_logout
    heartbeat                   ->  login       /   update_hb
    timer       &   timeout     ->  logout
    timer                       ->  login
    _                           ->  error

[logout]
    timer                       ->  logout
    _                           ->  error

[error]
    _                           ->  error
